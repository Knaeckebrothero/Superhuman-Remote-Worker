# yaml-language-server: $schema=schema.json
# Documentation Writer Agent - Uses OSS 120b with OpenAI vision fallback
$extends: defaults

agent_id: doc_writer
display_name: Documentation Writer
description: |
  Writes comprehensive project documentation by analyzing source materials
  including documents, presentations, spreadsheets, and code.

llm:
  # OSS 120b model (text-only) on custom OpenAI-compatible endpoint
  model: openai/gpt-oss-120b
  temperature: 0.1
  reasoning_level: high
  timeout: 600
  # Text-only model - visual content (PDFs, images) will be described
  # via VisionHelper using OpenAI gpt-4o-mini (configured via env vars)
  multimodal: false

workspace:
  structure:
    - archive/
    - tools/
    - output/
    - sources/
  instructions_template: doc_writer_instructions.md
  max_read_words: 50000
  # Git versioning for workspace history and audit trail
  git_versioning: true
  git_ignore_patterns:
    - "*.db"
    - "*.log"
    - "__pycache__/"
    - ".DS_Store"
    - "*.pyc"

# Tools for documentation work
tools:
  workspace:
    - read_file
    - write_file
    - edit_file
    - list_files
    - delete_file
    - search_files
    - file_exists
    - move_file
    - rename_file
    - copy_file
    - get_workspace_summary
    - get_document_info
  core:
    - next_phase_todos
    - todo_complete
    - todo_list
    - todo_rewind
    - mark_complete
    - job_complete
  document:
    - chunk_document
  research:
    - web_search
  citation:
    - cite_document
    - cite_web
    - list_sources
    - get_citation
    - list_citations
  # Git tools for reviewing workspace history
  git:
    - git_log
    - git_show
    - git_diff
    - git_status
    - git_tags

todo:
  archive_on_reset: true
  archive_path: archive/

connections:
  postgres: true
  neo4j: false

# Limits adjusted for 100k context model
limits:
  context_threshold_tokens: 80000
  message_count_threshold: 200
  message_count_min_tokens: 40000
  model_max_context_tokens: 100000
  summarization_safe_limit: 100000
  summarization_chunk_size: 80000

context_management:
  compact_on_archive: true
  keep_recent_tool_results: 15
  keep_recent_messages: 15

document_processing:
  chunking_strategy: general
  max_chunk_size: 1000
  chunk_overlap: 200
  extraction_mode: balanced
  min_confidence_threshold: 0.5

research:
  web_search_enabled: true
  graph_search_enabled: false
  research_depth: standard

validation:
  duplicate_threshold: 0.9
  require_citations: false
  metamodel_validation_strict: false
  fulfillment_confidence_threshold: 0.5
  auto_integrate: false
